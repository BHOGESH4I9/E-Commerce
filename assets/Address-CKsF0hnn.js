import{r as u,d as x,j as e,C as I,e as j,f as F,u as A,o,B as v,a as H}from"./index-c8tRdVzQ.js";import{c as M,a as h,u as E}from"./index.esm-DjCyUeUY.js";function w(t,r){return Array.isArray(t)?t.includes(r):t===r}const y=u.createContext({});y.displayName="AccordionContext";const b=u.forwardRef(({as:t="div",bsPrefix:r,className:a,children:l,eventKey:i,...s},d)=>{const{activeEventKey:n}=u.useContext(y);return r=x(r,"accordion-collapse"),e.jsx(I,{ref:d,in:w(n,i),...s,className:j(a,r),children:e.jsx(t,{children:u.Children.only(l)})})});b.displayName="AccordionCollapse";const g=u.createContext({eventKey:""});g.displayName="AccordionItemContext";const B=u.forwardRef(({as:t="div",bsPrefix:r,className:a,onEnter:l,onEntering:i,onEntered:s,onExit:d,onExiting:n,onExited:c,...N},p)=>{r=x(r,"accordion-body");const{eventKey:C}=u.useContext(g);return e.jsx(b,{eventKey:C,onEnter:l,onEntering:i,onEntered:s,onExit:d,onExiting:n,onExited:c,children:e.jsx(t,{ref:p,...N,className:j(a,r)})})});B.displayName="AccordionBody";function K(t,r){const{activeEventKey:a,onSelect:l,alwaysOpen:i}=u.useContext(y);return s=>{let d=t===a?null:t;i&&(Array.isArray(a)?a.includes(t)?d=a.filter(n=>n!==t):d=[...a,t]:d=[t]),l?.(d,s),r?.(s)}}const f=u.forwardRef(({as:t="button",bsPrefix:r,className:a,onClick:l,...i},s)=>{r=x(r,"accordion-button");const{eventKey:d}=u.useContext(g),n=K(d,l),{activeEventKey:c}=u.useContext(y);return t==="button"&&(i.type="button"),e.jsx(t,{ref:s,onClick:n,...i,"aria-expanded":Array.isArray(c)?c.includes(d):d===c,className:j(a,r,!w(c,d)&&"collapsed")})});f.displayName="AccordionButton";const S=u.forwardRef(({as:t="h2","aria-controls":r,bsPrefix:a,className:l,children:i,onClick:s,...d},n)=>(a=x(a,"accordion-header"),e.jsx(t,{ref:n,...d,className:j(l,a),children:e.jsx(f,{onClick:s,"aria-controls":r,children:i})})));S.displayName="AccordionHeader";const k=u.forwardRef(({as:t="div",bsPrefix:r,className:a,eventKey:l,...i},s)=>{r=x(r,"accordion-item");const d=u.useMemo(()=>({eventKey:l}),[l]);return e.jsx(g.Provider,{value:d,children:e.jsx(t,{ref:s,...i,className:j(a,r)})})});k.displayName="AccordionItem";const q=u.forwardRef((t,r)=>{const{as:a="div",activeKey:l,bsPrefix:i,className:s,onSelect:d,flush:n,alwaysOpen:c,...N}=F(t,{activeKey:"onSelect"}),p=x(i,"accordion"),C=u.useMemo(()=>({activeEventKey:l,onSelect:d,alwaysOpen:c}),[l,d,c]);return e.jsx(y.Provider,{value:C,children:e.jsx(a,{ref:r,...N,className:j(s,p,n&&`${p}-flush`)})})});q.displayName="Accordion";const m=Object.assign(q,{Button:f,Collapse:b,Item:k,Header:S,Body:B}),O=({activeKey:t,setActiveKey:r})=>{const{addresses:a,deleteAddress:l,selectedAddressIndex:i,setSelectedAddressIndex:s}=A(),d=n=>{s(n),r(n.toString())};return e.jsx(e.Fragment,{children:a.map((n,c)=>e.jsxs(m.Item,{eventKey:c.toString(),children:[e.jsxs(m.Header,{onClick:()=>r(c.toString()),children:[e.jsx(o.Check,{type:"radio",name:"selectedAddress",className:"me-2",checked:i===c,onChange:()=>d(c)}),e.jsx("strong",{children:n.name})," (",n.type,") - ",n.mobile]}),e.jsx(m.Body,{children:t===c.toString()&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"mb-1",children:n.address}),e.jsxs("p",{className:"mb-1",children:[n.city,", ",n.state," - ",n.pincode]}),e.jsxs("div",{className:"d-flex gap-2 mt-2",children:[e.jsx(v,{variant:"warning",children:"Deliver Here"}),e.jsx(v,{variant:"outline-danger",onClick:()=>l(c),children:"Delete"})]})]})})]},c))})},R=()=>{const{addAddress:t,setActiveAddressAccordionKey:r,activeAddressAccordionKey:a}=A(),l={name:"",mobile:"",address:"",city:"",state:"",pincode:"",type:"Home"},i=M({name:h().required("Name is required"),mobile:h().matches(/^[0-9]+$/,"Must be only digits").min(10,"Must be at least 10 digits").required("Mobile is required"),address:h().required("Address is required"),city:h().required("City is required"),state:h().required("State is required"),pincode:h().matches(/^[0-9]+$/,"Must be only digits").min(6,"Must be at least 6 digits").required("Pincode is required"),type:h().required("Type is required")}),s=E({initialValues:l,validationSchema:i,onSubmit:(n,{resetForm:c})=>{t(n),r(""),c()}}),d=()=>{r(a==="add"?"":"add")};return e.jsxs(m.Item,{eventKey:"add",children:[e.jsx(m.Header,{onClick:d,children:"+ Add a new address"}),e.jsx(m.Body,{children:a==="add"&&e.jsxs(o,{onSubmit:s.handleSubmit,className:"row g-3",children:[e.jsxs(o.Group,{className:"col-md-6",children:[e.jsx(o.Label,{children:"Name *"}),e.jsx(o.Control,{type:"text",name:"name",value:s.values.name,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.name&&!!s.errors.name}),s.touched.name&&s.errors.name&&e.jsx("div",{className:"text-danger mt-1",children:s.errors.name})]}),e.jsxs(o.Group,{className:"col-md-6",children:[e.jsx(o.Label,{children:"Mobile *"}),e.jsx(o.Control,{type:"tel",name:"mobile",value:s.values.mobile,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.mobile&&!!s.errors.mobile}),s.touched.mobile&&s.errors.mobile&&e.jsx("div",{className:"text-danger mt-1",children:s.errors.mobile})]}),e.jsxs(o.Group,{className:"col-md-6",children:[e.jsx(o.Label,{children:"Pincode *"}),e.jsx(o.Control,{type:"text",name:"pincode",value:s.values.pincode,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.pincode&&!!s.errors.pincode}),s.touched.pincode&&s.errors.pincode&&e.jsx("div",{className:"text-danger mt-1",children:s.errors.pincode})]}),e.jsxs(o.Group,{className:"col-md-6",children:[e.jsx(o.Label,{children:"City *"}),e.jsx(o.Control,{type:"text",name:"city",value:s.values.city,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.city&&!!s.errors.city}),s.touched.city&&s.errors.city&&e.jsx("div",{className:"text-danger mt-1",children:s.errors.city})]}),e.jsxs(o.Group,{className:"col-md-6",children:[e.jsx(o.Label,{children:"State *"}),e.jsx(o.Control,{type:"text",name:"state",value:s.values.state,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.state&&!!s.errors.state}),s.touched.state&&s.errors.state&&e.jsx("div",{className:"text-danger mt-1",children:s.errors.state})]}),e.jsxs(o.Group,{className:"col-md-6",children:[e.jsx(o.Label,{children:"Address *"}),e.jsx(o.Control,{as:"textarea",rows:2,name:"address",value:s.values.address,onChange:s.handleChange,onBlur:s.handleBlur,isInvalid:s.touched.address&&!!s.errors.address}),s.touched.address&&s.errors.address&&e.jsx("div",{className:"text-danger mt-1",children:s.errors.address})]}),e.jsxs(o.Group,{className:"col-md-12",children:[e.jsx(o.Label,{children:"Address Type"}),e.jsxs("div",{children:[e.jsx(o.Check,{inline:!0,type:"radio",name:"type",label:"Home",value:"Home",checked:s.values.type==="Home",onChange:s.handleChange}),e.jsx(o.Check,{inline:!0,type:"radio",name:"type",label:"Work",value:"Work",checked:s.values.type==="Work",onChange:s.handleChange})]}),s.touched.type&&s.errors.type&&e.jsx("div",{className:"text-danger mt-1",children:s.errors.type})]}),e.jsx("div",{className:"text-end",children:e.jsx(v,{type:"submit",className:"btn btn-primary px-4 mt-3",children:"Save and Deliver Here"})})]})})]})},L=()=>{const[t,r]=u.useState("");return e.jsxs("div",{className:"container my-4",children:[e.jsx("h4",{className:"mb-4 fw-bold",children:"1. Delivery Address"}),e.jsxs(m,{activeKey:t,onSelect:a=>r(a),alwaysOpen:!0,children:[e.jsx(O,{activeKey:t,setActiveKey:r}),e.jsx(R,{activeKey:t,setActiveKey:r})]})]})},D=()=>{const{cartItems:t}=A(),r=H(),a=n=>Math.round(n.price/(1-n.discountPercentage/100)),l=()=>t.reduce((n,c)=>n+a(c)*c.quantity,0),i=()=>t.reduce((n,c)=>n+(a(c)-c.price)*c.quantity,0),s=()=>3,d=()=>l()-i()+s();return e.jsxs("div",{className:"container my-4",children:[e.jsx("h4",{className:"mb-4 fw-bold",children:"2. Order Summary"}),e.jsx(m,{defaultActiveKey:"0",children:e.jsxs(m.Item,{eventKey:"0",children:[e.jsx(m.Header,{children:"View Order Summary"}),e.jsxs(m.Body,{children:[t.map(n=>e.jsxs("div",{className:"d-flex justify-content-between align-items-center border-bottom py-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"fw-semibold",children:n.title}),e.jsxs("small",{children:["Qty: ",n.quantity," × ₹",n.price]})]}),e.jsxs("div",{className:"fw-bold",children:["₹",n.quantity*n.price]})]},n.id)),e.jsx("hr",{}),e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("span",{children:"Total MRP"}),e.jsxs("span",{children:["₹",l()]})]}),e.jsxs("div",{className:"d-flex justify-content-between text-success",children:[e.jsx("span",{children:"Discount"}),e.jsxs("span",{children:["- ₹",i().toFixed(2)]})]}),e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("span",{children:"Platform Fee"}),e.jsxs("span",{children:["₹",s()]})]}),e.jsx("hr",{}),e.jsxs("div",{className:"d-flex justify-content-between fw-bold",children:[e.jsx("span",{children:"Total Amount"}),e.jsxs("span",{children:["₹",d().toFixed(2)]})]}),e.jsxs("div",{className:"text-success mt-2",children:["You will save ₹",(i()-s()).toFixed(2)," on this order"]}),e.jsx("div",{className:"text-end mt-4",children:e.jsx(v,{variant:"primary",onClick:()=>r("/checkout/payment"),children:"Continue"})})]})]})})]})},P=()=>e.jsxs("div",{className:"container",children:[e.jsx("h3",{className:"fw-bold mb-4",children:"Checkout"}),e.jsx(L,{}),e.jsx(D,{})]});export{P as default};
